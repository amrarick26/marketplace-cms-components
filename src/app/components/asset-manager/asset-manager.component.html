
<h1>Assets</h1>
<ngb-tabset (tabChange)="onChangeTab($event.nextId)">
  <ngb-tab ngbTabContent
            *ngFor="let type of assetTypes"
            title="{{type}}s">
    <ng-template ngbTabContent>
      <div class="tab-container">
        <form *ngIf="assetForms"
              [formGroup]="assetForms">
          <button class="btn btn-primary"
                  (click)="addAssetForm()">Upload {{type}}</button>
          <div formArrayName="Assets"
                *ngFor="let asset of assetForms.get('Assets').controls; index as i">
            <div class="row"
                  [formGroupName]="i">
              <div class="form-group col-sm-4">
                <img *ngIf="asset.controls['Url'].value && type == 'Image'"
                      class="card-img-top img-fluid flex-shrink-0"
                      [src]="asset.controls['Url'].value">
                <input [hidden]="true"
                        class="form-control"
                        id="image_{{i}}"
                        type="file"
                        accept="image/*,.pdf"
                        (change)="uploadFile($event, i)"
                        placeholder="Upload file" />
                <button type="button"
                        class="btn btn-default">
                  <label class="mb-0"
                          for="image_{{i}}">
                    <!-- <fa-icon [icon]="faUpload"></fa-icon> -->
                    <small>
                      {{asset.controls['Url'].value ? 'Replace' : 'Add'}}
                      <span class="d-none d-sm-block">{{type}}</span>
                    </small>
                  </label>
                </button>
              </div>
              <div class="form-group col-sm-8">
                <label for="Title">Title</label>
                <input type="text"
                        formControlName="Title"
                        class="form-control"
                        id="Title"
                        placeholder="Title"
                        autofocus="true"
                        pattern="([A-Za-z0-9\-\_]+)"
                        autocomplete="off" />
                <label for="ID">ID</label>
                <input type="text"
                        formControlName="ID"
                        class="form-control"
                        id="ID"
                        placeholder="ID"
                        autofocus="true"
                        pattern="([A-Za-z0-9\-\_]+)"
                        autocomplete="off" />
                <label for="Url">Url</label>
                <input type="text"
                        formControlName="Url"
                        class="form-control"
                        id="Url"
                        placeholder="Url"
                        autofocus="true"
                        autocomplete="off" />
                <div class="checkbox">
                  <label for="Active">
                    <input formControlName="Active"
                            type="checkbox"
                            id="Active">
                    Active
                  </label>
                </div>
                <button class="btn btn-sm btn-primary"
                        [disabled]="!formValid()"
                        (click)="saveChanges(asset, i)">Save Changes</button>
                <button class="btn btn-sm btn-danger"
                        (click)="deleteAsset(asset)">Delete Asset</button>
              </div>
            </div>
          </div>
        </form>
        <div *ngIf="!assets?.Items.length">
          No {{type}}s found
        </div>
      </div>
    </ng-template>
  </ngb-tab>
</ngb-tabset>